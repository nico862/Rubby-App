{"version":3,"sources":["app/services/customer-service.ts"],"names":[],"mappings":";AACA,MAAY,KAAK,WAAM,OAAO,CAAC,CAAA;AAG/B,sBAAmC,cAAc,CAAC,CAAA;AAClD,MAAY,EAAE,WAAM,aAAa,CAAC,CAAA;AAElC,yBAAyC,WAAW,CAAC,CAAA;AAErD,8BAA8B,IAAc;IAC1C,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;QACtB,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IAC7B,CAAC;IACD,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,eAAS,CAAC,CAAC;IAEhC,MAAM,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,kBAAkB,CAAC;SAC5C,IAAI,CAAC,WAAW,CAAC;SACjB,KAAK,CAAC,kBAAkB,EAAE,GAAG,CAAC,CAAC;IAEpC,MAAM,CAAC,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,IAAS;QACvC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACpC,CAAC,CAAC,CAAC;AACL,CAAC;AAED,0BAA0B,GAAQ;IAChC,MAAM,MAAM,GAAmB;QAC7B,GAAG,EAAE,aAAO,CAAC,UAAU,EAAE,GAAG,CAAC,WAAW,CAAC;QACzC,SAAS,EAAE,GAAG,CAAC,cAAc;QAC7B,KAAK,EAAE,GAAG,CAAC,cAAc;QACzB,QAAQ,EAAE,GAAG,CAAC,cAAc;QAC5B,KAAK,EAAE,GAAG,CAAC,cAAc;KAC1B,CAAC;IAEF,MAAM,CAAC,IAAI,iBAAQ,CAAC,MAAM,CAAC,CAAC;AAC9B,CAAC;AAGD;kBAAe;IACb,sBAAA,oBAAoB;CACrB,CAAC","file":"customer-service.js","sourcesContent":["import * as express from \"express\";\nimport * as squel from \"squel\";\n\nimport config from \"../config\";\nimport { extractId, convert } from \"../utils/urn\";\nimport * as db from \"../database\";\nimport { ResourceNotFound } from \"../errors\";\nimport { Customer, CustomerParams } from \"../models\";\n\nfunction fetchCustomersByUrns(urns: string[]): Promise<any> {\n  if (urns.length === 0) {\n    return Promise.resolve([]);\n  }\n  const ids = urns.map(extractId);\n\n  const query = squel.select(db.squelSelectOptions)\n      .from(\"customers\")\n      .where(\"customer_id IN ?\", ids);\n\n  return db.doSelect(query).then((rows: any) => {\n    return rows.map(mapRowToCustomer);\n  });\n}\n\nfunction mapRowToCustomer(row: any): Customer {\n  const params: CustomerParams = {\n    urn: convert(\"customer\", row.customer_id),\n    firstName: row.customer_fname,\n    email: row.customer_email,\n    lastName: row.customer_lname,\n    phone: row.customer_phone\n  };\n\n  return new Customer(params);\n}\n\n\nexport default {\n  fetchCustomersByUrns\n};\n"]}